{
  "fileName" : "xbot_android_samp.apk",
  "day" : "2019-10-09",
  "findings" : [ {
    "source" : {
      "statement" : "Object[] pdus = (Object[]) intent.getExtras().get(\"pdus\");",
      "methodName" : "public void onReceive(Context context, Intent intent)",
      "className" : "com.address.core.SMSHandler",
      "lineNo" : 22,
      "targetName" : "getExtras",
      "targetNo" : 1,
      "jimpleStmt" : "$r6 = virtualinvoke $r2.<android.content.Intent: android.os.Bundle getExtras()>()"
    },
    "sink" : {
      "statement" : "Object result = fObj.call(RunService.getService().getScriptLoader().getContext(), this._scope, this._scope, args);",
      "methodName" : "public Object call(String funcName, Object[] args)",
      "className" : "com.address.core.Script",
      "lineNo" : 90,
      "targetName" : "call",
      "targetNo" : 1,
      "jimpleStmt" : "$r5 = interfaceinvoke $r7.<org.mozilla.javascript.Function: java.lang.Object call(org.mozilla.javascript.Context,org.mozilla.javascript.Scriptable,org.mozilla.javascript.Scriptable,java.lang.Object[])>($r10, $r4, $r3, $r2)"
    },
    "intermediateFlows" : [ {
      "statement" : "messages[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);",
      "methodName" : "public void onReceive(Context context, Intent intent)",
      "className" : "com.address.core.SMSHandler",
      "lineNo" : 30,
      "ID" : 1
    }, {
      "statement" : "sb.append(messages[i].getMessageBody());",
      "methodName" : "public void onReceive(Context context, Intent intent)",
      "className" : "com.address.core.SMSHandler",
      "lineNo" : 31,
      "ID" : 2
    }, {
      "statement" : "if (RunService.getService().onSMSReceived(messages[0].getOriginatingAddress(), sb.toString()).booleanValue()) {",
      "methodName" : "public void onReceive(Context context, Intent intent)",
      "className" : "com.address.core.SMSHandler",
      "lineNo" : 37,
      "ID" : 3
    }, {
      "statement" : "getScriptLoader().call(\"onSMS\", num, text);",
      "methodName" : "public Boolean onSMSReceived(String num, String text)",
      "className" : "com.address.core.RunService",
      "lineNo" : 648,
      "ID" : 4
    }, {
      "statement" : "((Script) it.next()).call(funcName, args);",
      "methodName" : "public void call(String funcName, Object... args)",
      "className" : "com.address.core.ScriptLoader",
      "lineNo" : 122,
      "ID" : 5
    }, {
      "statement" : "Function fObj = this._scope.get(funcName, this._scope);",
      "methodName" : "public String getName()",
      "className" : "com.address.core.Script",
      "lineNo" : 83,
      "ID" : 6
    } ],
    "attributes" : {
      "array" : true,
      "interComponentCommunication" : true,
      "interProcedural" : true,
      "lifecycle" : true,
      "objectSensitive" : true,
      "partialFlow" : true,
      "reflection" : true
    },
    "ID" : 1,
    "description" : "This malicious partial ICC flow starts by reading the Intent with which the SMSHandler BroadcasReceiver started. The intent contains SMS messagees, which will be sent to a remote server with some script call defined by the malware writer.  "
  }, {
    "source" : {
      "statement" : "ret[0] = this.telemgr.getDeviceId();",
      "methodName" : "public String[] getTelephonyInfo()",
      "className" : "com.address.core.xAPI",
      "lineNo" : 89,
      "targetName" : "getDeviceId",
      "targetNo" : 1,
      "jimpleStmt" : "$r3 = virtualinvoke $r2.<android.telephony.TelephonyManager: java.lang.String getDeviceId()>()"
    },
    "sink" : {
      "statement" : "web.addJavascriptInterface(RunService.getService().getAPI(), \"xAPI\");",
      "methodName" : "public void onCreate(Bundle icicle)",
      "className" : "com.address.core.activities.BrowserActivity",
      "lineNo" : 47,
      "targetName" : "addJavascriptInterface",
      "targetNo" : 1,
      "jimpleStmt" : "virtualinvoke $r3.<android.webkit.WebView: void addJavascriptInterface(java.lang.Object,java.lang.String)>($r10, \"xAPI\")"
    },
    "intermediateFlows" : [ {
      "statement" : "return ret;",
      "methodName" : "public String[] getTelephonyInfo()",
      "className" : "com.address.core.xAPI",
      "lineNo" : 96,
      "ID" : 1
    } ],
    "attributes" : {
      "array" : true,
      "interProcedural" : true
    },
    "ID" : 2,
    "description" : "This malicious flow reads the device id and put it into an Array of String, the array is used as the return value of the method getTelephonyInfo() of the class xAPI. An object of xAPI is injected into the WebView by addJavascriptInterface. The method getTelephonyInfo() can be invoked via JavaScript code.  "
  } ]
}